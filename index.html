<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formularz GUS - Dostępność Architektoniczna</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            padding: 20px;
        }

        .container {
            max-width: 700px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h2 {
            text-align: center;
            color: #333;
        }

        label,
        p {
            font-weight: bold;
            margin-top: 15px;
            display: block;
            color: #333;
        }

        input[type="number"],
        input[type="email"],
        input[type="text"],
        textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        input[type="radio"] {
            margin-right: 10px;
        }

        .radio-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 5px;
        }

        button {
            background-color: #007bff;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            width: 100%;
            margin-top: 20px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .helper-text {
            font-size: 14px;
            /* Mniejsza czcionka */
            color: #777;
            /* Wyszarzony tekst */
            margin-top: 5px;
        }

        .hidden {
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            transition: opacity 0.3s ease-out, max-height 0.3s ease-out;
        }

        .visible {
            opacity: 1;
            max-height: 100px;
            transition: opacity 0.3s ease-in, max-height 0.3s ease-in;
        }

        .small-text {
            font-size: 14px;
            color: #6c757d;
            margin-top: 5px;
            transition: opacity 0.3s ease, max-height 0.3s ease;
        }

        .toggle-button {
            font-size: 12px;
            background-color: transparent;
            border: none;
            background-color: gray;
            cursor: pointer;
            width: 20%;
            white-space: nowrap;
        }

        .toggle-button:hover {
            background-color: darkgray;
        }

        .comment-header,
        .number-of-applications-header {
            display: flex;
            align-items: center;
            gap: 10px;
            /* Odstęp między tekstem a przyciskiem */
        }

        .container-gap {
            margin-top: 25px;
        }

        .disabled-group {
            opacity: 0.5;
            /* Wyszarzenie dla etykiet i pól */
            pointer-events: none;
            /* Wyłączenie interakcji */
        }

        .enabled-group {
            opacity: 1;
            /* Przywrócenie normalnego wyglądu */
            pointer-events: auto;
            /* Aktywacja interakcji */
        }

        .hidden-section {
            display: none;
            /* Domyślnie ukryte */
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
            margin-bottom: 10px;
            /* Zapobiega ściskaniu poniższych elementów */
        }

        .actionButtons {
            display: none;
            /* Ukryty domyślnie */
            gap: 10px;
            margin-top: 10px;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }

        .actionButtons.show {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <h2>Dane Główne</h2>
        <form id="mainDataForm">

            <!-- Nazwa i adres podmiotu -->
            <label for="institution_name">Nazwa i adres podmiotu publicznego:</label>
            <input type="text" id="institution_name" name="institution_name" required>

            <!-- REGON -->
            <label for="regon">Numer identyfikacyjny REGON (wpisać, jeśli podmiot posiada):</label>
            <input type="text" id="regon" name="regon">

            <!-- Email sekretariatu -->
            <label for="email_secretariat">E-mail sekretariatu podmiotu:</label>
            <input type="email" id="email_secretariat" name="email_secretariat" required>

            <!-- Lokalizacja -->
            <p>Lokalizacja siedziby podmiotu:</p>

            <label for="province">Województwo:</label>
            <input type="text" id="province" name="province" required>

            <label for="county">Powiat:</label>
            <input type="text" id="county" name="county" required>

            <label for="municipality">Gmina:</label>
            <input type="text" id="municipality" name="municipality" required>

            <!-- Przycisk do wysłania formularza -->
            <button type="button" class="showActionsButton" data-target="mainDataActionButtons" style="display: none;">
                Zapisz dane główne
            </button>
            <div id="mainDataActionButtons" class="actionButtons">
                <button id="saveMainDataButton" type="submit">Zapisz</button>
            </div>

        </form>
    </div>

    <div class="container container-gap">
        <h2>Dostępność Architektoniczna</h2>
        <form id="archForm">

            <label for="num_buildings">Liczba budynków, w których podmiot prowadzi podstawową działalność i/lub obsługę
                interesantów:</label>
            <input type="number" id="num_buildings" name="num_buildings" required>

            <p>1. Wolne od barier przestrzenie komunikacyjne w budynkach:</p>
            <label for="barrier_free_all">a. Liczba budynków, w których podmiot zapewnia wolne od barier wszystkie
                przestrzenie komunikacyjne:</label>
            <input type="number" id="barrier_free_all" name="barrier_free_all">

            <label for="barrier_free_partial">b. Liczba budynków, w których podmiot częściowo zapewnia wolne od barier
                przestrzenie komunikacyjne:</label>
            <input type="number" id="barrier_free_partial" name="barrier_free_partial">

            <label for="barrier_free_none">c. Liczba budynków, w których podmiot nie zapewnia wolnych od barier
                przestrzeni komunikacyjnych:</label>
            <input type="number" id="barrier_free_none" name="barrier_free_none">

            <p>2. Dostęp do wszystkich pomieszczeń w budynkach (z wyłączeniem pomieszczeń technicznych):</p>
            <label for="room_access_all">a. Liczba budynków, w których podmiot umożliwia dostęp do wszystkich
                pomieszczeń:</label>
            <input type="number" id="room_access_all" name="room_access_all">

            <label for="room_access_none">b. Liczba budynków, w których podmiot nie umożliwia dostępu do wszystkich
                pomieszczeń:</label>
            <input type="number" id="room_access_none" name="room_access_none">

            <p>c. Rodzaje rozwiązań, które podmiot zastosował, aby umożliwić dostęp do wszystkich pomieszczeń:</p>
            <label><input type="checkbox" name="room_access_solutions" value="Rozwiązania architektoniczne"> Rozwiązania
                architektoniczne</label>
            <label><input type="checkbox" name="room_access_solutions" value="Środki techniczne"> Środki
                techniczne</label>
            <label><input type="checkbox" name="room_access_solutions" value="Zainstalowane urządzenia"> Zainstalowane
                urządzenia</label>

            <p>3. Informacja na temat rozkładu pomieszczeń w budynkach:</p>
            <label for="layout_info_visual_tactile">a. Liczba budynków, w których podmiot zapewnia informację co
                najmniej w sposób wizualny i dotykowy:</label>
            <input type="number" id="layout_info_visual_tactile" name="layout_info_visual_tactile">

            <label for="layout_info_visual_voice">b. Liczba budynków, w których podmiot zapewnia informację co najmniej
                w sposób wizualny i głosowy:</label>
            <input type="number" id="layout_info_visual_voice" name="layout_info_visual_voice">

            <label for="layout_info_all">c. Liczba budynków, w których podmiot zapewnia informację co najmniej w sposób
                wizualny, dotykowy i głosowy:</label>
            <input type="number" id="layout_info_all" name="layout_info_all">

            <p>4. Dostęp do budynków dla osób korzystających z psa asystującego:</p>
            <label for="dog_access_yes">a. Liczba budynków, do których podmiot zapewnia wstęp osobie korzystającej z psa
                asystującego:</label>
            <input type="number" id="dog_access_yes" name="dog_access_yes">

            <label for="dog_access_no">b. Liczba budynków, do których podmiot nie zapewnia wstępu osobie korzystającej z
                psa asystującego:</label>
            <input type="number" id="dog_access_no" name="dog_access_no">

            <p>5. Ewakuacja lub ratowanie osób wewnątrz budynków:</p>
            <p>a. Aby umożliwić ewakuację lub ratowanie osób wewnątrz budynków, podmiot zapewnia:</p>

            <label><input type="checkbox" name="evacuation_methods" value="Procedury ewakuacji lub ratowania"
                    onclick="updateEvacuationOptions()"> Procedury ewakuacji lub ratowania</label>
            <label><input type="checkbox" name="evacuation_methods"
                    value="Sprzęt lub miejsce do ewakuacji lub ratowania" onclick="updateEvacuationOptions()"> Sprzęt
                lub miejsce do ewakuacji lub ratowania</label>
            <label><input type="checkbox" name="evacuation_methods"
                    value="Pracowników przeszkolonych z procedur ewakuacji lub ratowania"
                    onclick="updateEvacuationOptions()"> Pracowników przeszkolonych z procedur ewakuacji lub
                ratowania</label>

            <div class="disabled-group">
                <label for="evacuation_full">b. Liczba budynków, w których podmiot zapewnia pełną ewakuację dla osób ze
                    szczególnymi potrzebami <span style="font-size: 12px;">(dotyczy tylko budynków, w których spełniono
                        wszystkie 3 warunki wskazane w pytaniu 5a)</span>:</label>
                <input type="number" id="evacuation_full" name="evacuation_full" disabled>
            </div>

            <div class="disabled-group">
                <label for="evacuation_partial">c. Liczba budynków, w których podmiot częściowo zapewnia ewakuację dla
                    osób ze szczególnymi potrzebami<span style="font-size: 12px;">(dotyczy tylko budynków, w których
                        spełniono co najmniej 1 z 3 warunków wskazanych w pytaniu 5a)</span>:</label>
                <input type="number" id="evacuation_partial" name="evacuation_partial" disabled>
            </div>

            <div class="disabled-group">
                <label for="evacuation_none">d. Liczba budynków, w których podmiot nie zapewnia ewakuacji dla osób ze
                    szczególnymi potrzebami<span style="font-size: 12px;">(dotyczy tylko budynków, w których nie
                        spełniono żadnego z warunków wskazanych w pytaniu 5a)</span>:</label>
                <input type="number" id="evacuation_none" name="evacuation_none" disabled>
            </div>

            <div class="comment-header">
                <label for="comments">Komentarze i uwagi dotyczące dostępności architektonicznej:</label>
                <button type="button" class="toggle-button" id="comments-helperButton"
                    onclick="toggleHelperText('comments-helperText', 'comments-helperButton')">Pokaż więcej</button>
            </div>
            <p id="comments-helperText" class="small-text hidden">
                Proszę zamieścić tu słowny opis dostępności architektonicznej, wykraczający poza informacje ujęte
                powyżej – opis ten będzie stanowić część raportu, który są Państwo zobowiązani opublikować na swojej
                stronie podmiotowej Biuletynu Informacji Publicznej, a w przypadku braku strony podmiotowej Biuletynu
                Informacji Publicznej – na swojej stronie internetowej.
            </p>
            <textarea id="comments" name="arch_comments" rows="4"></textarea>

            <!-- <label for="user_email">Podaj adres e-mail, na który ma zostać wysłana wiadomość:</label>
            <input type="email" id="user_email" name="user_email" required> -->

            <!-- Formularz Architektoniczny -->
            <button type="button" class="showActionsButton" data-target="archActionButtons"
                style="display: none;">Wyślij tylko dostępność
                architektoniczną</button>
            <div id="archActionButtons" class="actionButtons">
                <button type="submit">Wyślij mail</button>
                <button id="generateArchDocButton" type="button">Wygeneruj dokument</button>
            </div>
        </form>
    </div>

    <div class="container container-gap">
        <h2>Dostępność informacyjno-komunikacyjna</h2>
        <form id="infoForm">

            <p>1. Czy podmiot zapewnia osobom ze szczególnymi potrzebami obsługę z wykorzystaniem niżej wymienionych
                sposobów/środków wspierających komunikowanie się?</p>

            <p>a. Zastosowanie formularza kontaktowego</p>
            <div class="radio-group">
                <input type="radio" name="contact_form" value="TAK" required> TAK
                <input type="radio" name="contact_form" value="NIE"> NIE
            </div>

            <p>b. Kontakt za pomocą poczty elektronicznej</p>
            <div class="radio-group">
                <input type="radio" name="contact_mail" value="TAK" required> TAK
                <input type="radio" name="contact_mail" value="NIE"> NIE
            </div>

            <p>c. Przesyłanie wiadomości tekstowych, w tym z wykorzystaniem wiadomości SMS,
                MMS lub komunikatorów internetowych
            </p>
            <div class="radio-group">
                <input type="radio" name="contact_sms" value="TAK" required> TAK
                <input type="radio" name="contact_sms" value="NIE"> NIE
            </div>

            <p>d. Komunikacja audiowizualna, w tym z wykorzystaniem komunikatorów
                internetowych
            </p>
            <div class="radio-group">
                <input type="radio" name="contact_av" value="TAK" required> TAK
                <input type="radio" name="contact_av" value="NIE"> NIE
            </div>

            <p>e. Przesyłanie faksów</p>
            <div class="radio-group">
                <input type="radio" name="contact_fax" value="TAK" required> TAK
                <input type="radio" name="contact_fax" value="NIE"> NIE
            </div>

            <p>f. Wykorzystanie tłumacza języka migowego przez strony internetowe i/lub aplikacje
                (tłumaczenie online)
            </p>
            <div class="radio-group">
                <input type="radio" name="contact_sign_online" value="TAK" required> TAK
                <input type="radio" name="contact_sign_online" value="NIE"> NIE
            </div>

            <p>g. Pomoc tłumacza języka migowego – kontakt osobisty</p>
            <div class="radio-group">
                <input type="radio" name="contact_sign_personal" value="TAK" required
                    onclick="toggleInput('sign_lang_wrapper', 'sign_lang_time', true)"> TAK
                <input type="radio" name="contact_sign_personal" value="NIE"
                    onclick="toggleInput('sign_lang_wrapper', 'sign_lang_time', false)"> NIE
            </div>

            <div id="sign_lang_wrapper" class="hidden">
                <label for="sign_lang_time" class="helper-text">W przypadku zaznaczenia odpowiedzi „TAK” – prosimy
                    określić w jakim czasie od zgłoszenia potrzeby
                    podmiot zapewnia kontakt osobisty z tłumaczem języka migowego:
                </label>
                <select id="sign_lang_time" name="sign_lang_time">
                    <option value="od razu">od razu</option>
                    <option value="1 dzień">w ciągu 1 dnia roboczego</option>
                    <option value="2-3 dni">w ciągu 2-3 dni roboczych</option>
                    <option value="powyżej 3 dni">powyżej 3 dni roboczych</option>
                </select>
            </div>

            <p>h. Kontakt z pomocą tłumacza-przewodnika (kontakt osobisty)</p>
            <div class="radio-group">
                <input type="radio" name="contact_guide" value="TAK" required> TAK
                <input type="radio" name="contact_guide" value="NIE"> NIE
            </div>
            <p>2. Czy podmiot posiada urządzenia lub środki techniczne do obsługi osób słabosłyszących?</p>

            <p>a. Pętle indukcyjne</p>
            <div class="radio-group">
                <input type="radio" name="hearing_loop" value="TAK"
                    onclick="toggleInput('hearing_loop_count_wrapper', 'hearing_loop_count', true)"> TAK
                <input type="radio" name="hearing_loop" value="NIE"
                    onclick="toggleInput('hearing_loop_count_wrapper', 'hearing_loop_count', false)"> NIE
            </div>
            <div id="hearing_loop_count_wrapper" class="hidden">
                <label for="hearing_loop_count">Liczba urządzeń:</label>
                <input type="number" id="hearing_loop_count" name="hearing_loop_count" disabled>
            </div>

            <p>b. Systemy FM</p>
            <div class="radio-group">
                <input type="radio" name="fm_systems" value="TAK"
                    onclick="toggleInput('fm_systems_count_wrapper', 'fm_systems_count', true)"> TAK
                <input type="radio" name="fm_systems" value="NIE"
                    onclick="toggleInput('fm_systems_count_wrapper', 'fm_systems_count', false)"> NIE
            </div>
            <div id="fm_systems_count_wrapper" class="hidden">
                <label for="fm_systems_count">Liczba urządzeń:</label>
                <input type="number" id="fm_systems_count" name="fm_systems_count" disabled>
            </div>

            <p>c. Systemy na podczerwień (IR)</p>
            <div class="radio-group">
                <input type="radio" name="ir_systems" value="TAK"
                    onclick="toggleInput('ir_systems_count_wrapper', 'ir_systems_count', true)"> TAK
                <input type="radio" name="ir_systems" value="NIE"
                    onclick="toggleInput('ir_systems_count_wrapper', 'ir_systems_count', false)"> NIE
            </div>
            <div id="ir_systems_count_wrapper" class="hidden">
                <label for="ir_systems_count">Liczba urządzeń:</label>
                <input type="number" id="ir_systems_count" name="ir_systems_count" disabled>
            </div>

            <p>d. Systemy Bluetooth</p>
            <div class="radio-group">
                <input type="radio" name="bluetooth_systems" value="TAK"
                    onclick="toggleInput('bluetooth_systems_count_wrapper', 'bluetooth_systems_count', true)"> TAK
                <input type="radio" name="bluetooth_systems" value="NIE"
                    onclick="toggleInput('bluetooth_systems_count_wrapper', 'bluetooth_systems_count', false)"> NIE
            </div>
            <div id="bluetooth_systems_count_wrapper" class="hidden">
                <label for="bluetooth_systems_count">Liczba urządzeń:</label>
                <input type="number" id="bluetooth_systems_count" name="bluetooth_systems_count" disabled>
            </div>

            <p>e. Inne urządzenia lub środki techniczne</p>
            <div class="radio-group">
                <input type="radio" name="other_devices" value="TAK"
                    onclick="toggleInputGroup(true, 'other_devices_wrapper', ['other_devices_description', 'other_devices_count'])">
                TAK
                <input type="radio" name="other_devices" value="NIE"
                    onclick="toggleInputGroup(false, 'other_devices_wrapper', ['other_devices_description', 'other_devices_count'])">
                NIE
            </div>

            <div id="other_devices_wrapper" class="hidden-section">
                <label for="other_devices_description">Prosimy o opis słowny posiadanych urządzeń lub środków
                    technicznych</label>
                <textarea id="other_devices_description" name="other_devices_description" rows="3" disabled></textarea>

                <label for="other_devices_count">Liczba urządzeń:</label>
                <input type="number" id="other_devices_count" name="other_devices_count" disabled>
            </div>

            <p>3. Czy podmiot zapewnia na swojej głównej stronie internetowej informację o zakresie swojej działalności
                (głównych zadaniach podmiotu) w postaci</p>

            <p>a. Tekstu odczytywalnego maszynowo?</p>
            <div class="radio-group">
                <input type="radio" name="machine_readable_text" value="TAK" required> TAK
                <input type="radio" name="machine_readable_text" value="NIE"> NIE
            </div>

            <p>b. Nagrania treści w polskim języku migowym (PJM) w postaci pliku wideo?</p>
            <div class="radio-group">
                <input type="radio" name="pjm_video" value="TAK" required> TAK
                <input type="radio" name="pjm_video" value="NIE"> NIE
            </div>

            <p>c. Informacji w tekście łatwym do czytania (ETR)?</p>
            <div class="radio-group">
                <input type="radio" name="easy_read_text" value="TAK" required> TAK
                <input type="radio" name="easy_read_text" value="NIE"> NIE
            </div>

            <p>4. Czy w okresie sprawozdawczym podmiot otrzymał od osób ze
                szczególnymi potrzebami wniosek o zapewnienie szczególnej formy komunikacji?
                <span style="font-size: 12px;">(na podstawie art. 6 pkt 3 lit.d UzD)</span>
            </p>
            <div class="radio-group">
                <input type="radio" name="communication_request" value="TAK"
                    onclick="toggleInputGroup(true, 'communication_details_wrapper', ['communication_count', 'communication_details'])">
                TAK
                <input type="radio" name="communication_request" value="NIE"
                    onclick="toggleInputGroup(false, 'communication_details_wrapper', ['communication_count', 'communication_details'])">
                NIE
            </div>

            <div id="communication_details_wrapper" class="hidden-section">
                <label for="communication_count">Liczba wniosków – ogółem:</label>
                <input type="number" id="communication_count" name="communication_count" disabled>

                <label for="communication_details">
                    Nazwy użytych form komunikacji określonych we wnioskach ze wskazaniem liczby użyć każdej z tych form
                    (wpisać słownie np. alfabet Lorma - 1 raz, druk w alfabecie Braille’a - 3 razy)
                </label>
                <textarea id="communication_details" name="communication_details" rows="4" disabled></textarea>
            </div>


            <p>Komentarze i uwagi dotyczące dostępności informacyjno-komunikacyjnej <span
                    style="font-size: 12px;">(proszę zamieścić tu słowny opis dostępności informacyjno-komunikacyjnej,
                    wykraczający poza informacje ujęte powyżej – opis ten będzie stanowić część raportu, który są
                    Państwo zobowiązani opublikować na swojej stronie podmiotowej Biuletynu Informacji Publicznej, a w
                    przypadku braku strony podmiotowej Biuletynu Informacji Publicznej – na swojej stronie
                    internetowej)</span>:</p>
            <textarea id="comments" name="comments" rows="4"></textarea>

            <!-- <label for="user_email">Podaj adres e-mail:</label>
            <input type="email" id="user_email" name="user_email" required> -->

            <button type="button" class="showActionsButton" data-target="infoActionButtons"
                style="display: none;">Wyślij tylko dostępność
                informacyjno-komunikacyjną</button>
            <div id="infoActionButtons" class="actionButtons">
                <button type="submit">Wyślij mail</button>
                <button id="generateInfoDocButton" type="button">Wygeneruj dokument</button>
            </div>

        </form>
    </div>

    <div class="container container-gap">
        <label for="user_email">Podaj adres e-mail:</label>
        <input type="email" id="user_email" name="user_email" required>
    </div>

    <div class="container container-gap">
        <button type="button" class="showActionsButton" data-target="bothActionButtons">
            Wyślij oba formularze
        </button>
        <div id="bothActionButtons" class="actionButtons">
            <button id="sendBothFormsButton" type="button">Wyślij mail</button>
            <button id="generateBothDocsButton" type="button">Wygeneruj dokument</button>

            <!-- Nowe pole do wpisania ID arkusza -->
            <div style="display: flex; flex-direction: column;">
                <input type="text" id="sheetIdInput" placeholder="Wpisz ID arkusza Google">
                <button id="saveToSheetButton" type="button">Zapisz do arkusza</button>
            </div>
        </div>

        <!-- Spinner ładowania -->
        <div id="loadingSpinner" class="loading-spinner" style="display: none;">
            <div class="spinner"></div>
        </div>
    </div>





</body>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        function handleFormSubmit(event, formType) {
            event.preventDefault();
            showLoading();

            const formData = new FormData(event.target);
            let data = Object.fromEntries(formData.entries());

            // Resetowanie checkboxów jako tablic
            document.querySelectorAll(`#${event.target.id} input[type="checkbox"]`).forEach((checkbox) => {
                if (!data[checkbox.name]) {
                    data[checkbox.name] = []; // Inicjalizujemy jako tablicę
                } else if (!Array.isArray(data[checkbox.name])) {
                    data[checkbox.name] = [data[checkbox.name]]; // Konwersja do tablicy
                }
            });

            // Dodawanie zaznaczonych wartości, ale unikamy duplikatów
            document.querySelectorAll(`#${event.target.id} input[type="checkbox"]:checked`).forEach((checkbox) => {
                if (!data[checkbox.name].includes(checkbox.value)) {
                    data[checkbox.name].push(checkbox.value);
                }
            });

            data.formType = formType;
            console.log("Wysyłanie formularza:", event.target.id, data);

            fetch("http://localhost:3000/send-form", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data),
            })
                .then(response => response.text())
                .then(result => {
                    alert(result);
                })
                .catch(error => {
                    console.error("Błąd podczas wysyłania formularza:", error);
                    alert("Wystąpił błąd podczas wysyłania formularza.");
                }).finally(() => {
                    hideLoading(); // Ukryj spinner niezależnie od wyniku
                });
        }

        // Obsługa formularza Dostępności Architektonicznej
        document.getElementById("archForm").addEventListener("submit", function (event) {
            handleFormSubmit(event, "architectural");
        });

        // Obsługa formularza Dostępności Informacyjno-Komunikacyjnej (jeśli istnieje)
        document.getElementById("infoForm")?.addEventListener("submit", function (event) {
            handleFormSubmit(event, "informational");
        });

        const showButtons = document.querySelectorAll(".showActionsButton");

        showButtons.forEach(button => {
            button.addEventListener("click", function () {
                const targetId = this.getAttribute("data-target");
                const actionButtons = document.getElementById(targetId);

                this.style.display = "none"; // Ukrywa przycisk "Wyślij"
                actionButtons.style.display = "flex"; // Pokazuje kontener przycisków
                setTimeout(() => {
                    actionButtons.classList.add("show"); // Aktywuje animację
                }, 10); // Krótkie opóźnienie, aby animacja działała płynnie
            });
        });
    });

    function toggleInput(wrapperId, inputId, isEnabled) {
        const wrapper = document.getElementById(wrapperId);
        const inputField = document.getElementById(inputId);

        if (isEnabled) {
            wrapper.classList.add("visible");
            wrapper.classList.remove("hidden");
            inputField.disabled = !isEnabled;
            inputField.setAttribute("required", "true");
        } else {
            wrapper.classList.add("hidden");
            wrapper.classList.remove("visible");
            inputField.value = "";
            inputField.removeAttribute("required");
        }
    }

    function toggleHelperText(helperTextId, buttonId) {
        const helperText = document.getElementById(helperTextId);
        const button = document.getElementById(buttonId);

        if (helperText.classList.contains("hidden")) {
            helperText.classList.remove("hidden");
            helperText.classList.add("visible");
            button.textContent = "Ukryj";
        } else {
            helperText.classList.remove("visible");
            helperText.classList.add("hidden");
            button.textContent = "Pokaż więcej";
        }
    }

    function updateEvacuationOptions() {
        const checkboxes = document.querySelectorAll('input[name="evacuation_methods"]:checked');
        const fullGroup = document.getElementById('evacuation_full').parentElement;
        const partialGroup = document.getElementById('evacuation_partial').parentElement;
        const noneGroup = document.getElementById('evacuation_none').parentElement;

        let checkedCount = checkboxes.length;

        // Resetujemy wszystkie grupy do domyślnego stanu (wyszarzone)
        [fullGroup, partialGroup, noneGroup].forEach(group => {
            group.classList.add('disabled-group');
            group.classList.remove('enabled-group');
            group.querySelector('input').value = ""; // Czyszczenie wartości pola
            group.querySelector('input').disabled = true;
        });

        // Aktywujemy odpowiednie grupy w zależności od liczby zaznaczonych checkboxów
        if (checkedCount === 3) {
            fullGroup.classList.remove('disabled-group');
            fullGroup.classList.add('enabled-group');
            fullGroup.querySelector('input').disabled = false;
        } else if (checkedCount > 0) {
            partialGroup.classList.remove('disabled-group');
            partialGroup.classList.add('enabled-group');
            partialGroup.querySelector('input').disabled = false;
        } else {
            noneGroup.classList.remove('disabled-group');
            noneGroup.classList.add('enabled-group');
            noneGroup.querySelector('input').disabled = false;
        }
    }

    // Wywołanie funkcji przy starcie, aby opcja „d” była aktywna
    document.addEventListener("DOMContentLoaded", function () {
        updateEvacuationOptions();
    });

    function toggleInputGroup(isEnabled, wrapperId, inputIds) {
        const wrapper = document.getElementById(wrapperId);
        const inputs = inputIds.map(id => document.getElementById(id));

        if (isEnabled) {
            wrapper.style.display = "flex"; // Pokazuje sekcję
            inputs.forEach(input => {
                input.disabled = false;
            });
        } else {
            wrapper.style.display = "none"; // Ukrywa sekcję
            inputs.forEach(input => {
                input.disabled = true;
                input.value = ""; // Resetuje pola po odznaczeniu
            });
        }
    }

    document.getElementById('generateInfoDocButton').addEventListener('click', async () => {
        showLoading();
        const form = document.getElementById('infoForm');
        const formData = new FormData(form);
        let data = Object.fromEntries(formData.entries());

        // Przetwarzanie checkboxów jako tablic
        document.querySelectorAll(`#${form.id} input[type="checkbox"]`).forEach((checkbox) => {
            if (!data[checkbox.name]) {
                data[checkbox.name] = []; // Inicjalizacja jako tablica
            } else if (!Array.isArray(data[checkbox.name])) {
                data[checkbox.name] = [data[checkbox.name]]; // Konwersja do tablicy
            }
        });

        // Dodawanie zaznaczonych wartości
        document.querySelectorAll(`#${form.id} input[type="checkbox"]:checked`).forEach((checkbox) => {
            if (!data[checkbox.name].includes(checkbox.value)) {
                data[checkbox.name].push(checkbox.value);
            }
        });

        console.log("Generowanie dokumentu - infoForm:", data);

        const response = await fetch('http://localhost:3000/generate-document', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.success) {
            alert(`Dokument został utworzony: ${result.url}`);
            window.open(result.url, '_blank'); // Otwiera nowy dokument
        } else {
            alert('Wystąpił błąd podczas generowania dokumentu.');
        }
        hideLoading();
    });

    document.getElementById('generateArchDocButton').addEventListener('click', async () => {
        showLoading();
        const form = document.getElementById('archForm');
        const formData = new FormData(form);
        let data = Object.fromEntries(formData.entries());

        // Przetwarzanie checkboxów jako tablic
        document.querySelectorAll(`#${form.id} input[type="checkbox"]`).forEach((checkbox) => {
            if (!data[checkbox.name]) {
                data[checkbox.name] = []; // Inicjalizacja jako tablica
            } else if (!Array.isArray(data[checkbox.name])) {
                data[checkbox.name] = [data[checkbox.name]]; // Konwersja do tablicy
            }
        });

        // Dodawanie zaznaczonych wartości
        document.querySelectorAll(`#${form.id} input[type="checkbox"]:checked`).forEach((checkbox) => {
            if (!data[checkbox.name].includes(checkbox.value)) {
                data[checkbox.name].push(checkbox.value);
            }
        });

        console.log("Generowanie dokumentu - archForm:", data);

        const response = await fetch('http://localhost:3000/generate-document', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
        });

        const result = await response.json();
        if (result.success) {
            alert(`Dokument został utworzony: ${result.url}`);
            window.open(result.url, '_blank'); // Otwiera nowy dokument
        } else {
            alert('Wystąpił błąd podczas generowania dokumentu.');
        }

        hideLoading();
    });

    document.getElementById('sendBothFormsButton').addEventListener('click', async () => {
        showLoading();
        const archForm = document.getElementById('archForm');
        const infoForm = document.getElementById('infoForm');

        const archFormData = new FormData(archForm);
        const infoFormData = new FormData(infoForm);

        let archData = Object.fromEntries(archFormData.entries());
        let infoData = Object.fromEntries(infoFormData.entries());

        // Przetwarzanie checkboxów jako tablic
        function processCheckboxes(formId, data) {
            document.querySelectorAll(`#${formId} input[type="checkbox"]`).forEach((checkbox) => {
                if (!data[checkbox.name]) {
                    data[checkbox.name] = [];
                } else if (!Array.isArray(data[checkbox.name])) {
                    data[checkbox.name] = [data[checkbox.name]];
                }
            });

            document.querySelectorAll(`#${formId} input[type="checkbox"]:checked`).forEach((checkbox) => {
                if (!data[checkbox.name].includes(checkbox.value)) {
                    data[checkbox.name].push(checkbox.value);
                }
            });
        }

        processCheckboxes('archForm', archData);
        processCheckboxes('infoForm', infoData);

        const combinedData = {
            formType: "both", // Dodanie formType dla serwera!
            user_email: document.getElementById("user_email").value, // Pobranie emaila
            architectural: archData,
            informational: infoData
        };

        console.log("Wysyłanie obu formularzy:", combinedData);

        try {
            const response = await fetch("http://localhost:3000/send-form", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(combinedData),
            });

            const result = await response.text();
            alert(result);
        } catch (error) {
            console.error("Błąd podczas wysyłania formularzy:", error);
            alert("Wystąpił błąd podczas wysyłania formularzy.");
        } finally {
            hideLoading(); // Ukryj spinner niezależnie od wyniku
        }
    });

    document.getElementById('generateBothDocsButton').addEventListener('click', async () => {
        showLoading();
        const archForm = document.getElementById('archForm');
        const infoForm = document.getElementById('infoForm');
        const mainDataForm = document.getElementById('mainDataForm');

        const archFormData = new FormData(archForm);
        const infoFormData = new FormData(infoForm);
        const mainDataFormData = new FormData(mainDataForm);

        let archData = Object.fromEntries(archFormData.entries());
        let infoData = Object.fromEntries(infoFormData.entries());
        let mainData = Object.fromEntries(mainDataFormData.entries());

        // Jeśli numer REGON jest pusty, wpisujemy "Brak"
        if (!mainData.regon || mainData.regon.trim() === "") {
            mainData.regon = "Brak";
        }

        // Przetwarzanie checkboxów jako tablic
        function processCheckboxes(formId, data) {
            document.querySelectorAll(`#${formId} input[type="checkbox"]`).forEach((checkbox) => {
                if (!data[checkbox.name]) {
                    data[checkbox.name] = [];
                } else if (!Array.isArray(data[checkbox.name])) {
                    data[checkbox.name] = [data[checkbox.name]];
                }
            });

            document.querySelectorAll(`#${formId} input[type="checkbox"]:checked`).forEach((checkbox) => {
                if (!data[checkbox.name].includes(checkbox.value)) {
                    data[checkbox.name].push(checkbox.value);
                }
            });
        }

        processCheckboxes('archForm', archData);
        processCheckboxes('infoForm', infoData);

        const combinedData = {
            formType: "both", // Dodanie formType dla serwera
            user_email: document.getElementById("user_email").value, // Pobranie emaila
            mainData: mainData, // Dodanie danych głównych
            architectural: archData,
            informational: infoData
        };

        console.log("Generowanie dokumentów:", combinedData);

        try {
            const response = await fetch("http://localhost:3000/generate-document", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(combinedData),
            });

            const result = await response.json();
            if (result.success) {
                alert(`Dokument został utworzony.`);
                window.open(result.arch_url, '_blank');
                window.open(result.info_url, '_blank');
            } else {
                alert('Wystąpił błąd podczas generowania dokumentów.');
            }
        } catch (error) {
            console.error("Błąd podczas generowania dokumentów:", error);
            alert("Wystąpił błąd podczas generowania dokumentów.");
        } finally {
            hideLoading(); // Ukryj spinner niezależnie od wyniku
        }
    });

    document.getElementById('saveToSheetButton').addEventListener('click', async () => {
        showLoading();
        const archForm = document.getElementById('archForm');
        const infoForm = document.getElementById('infoForm');
        const sheetId = document.getElementById("sheetIdInput").value.trim();

        if (!sheetId) {
            alert("Proszę wpisać ID arkusza przed zapisaniem.");
            return;
        }

        const archFormData = new FormData(archForm);
        const infoFormData = new FormData(infoForm);

        let archData = Object.fromEntries(archFormData.entries());
        let infoData = Object.fromEntries(infoFormData.entries());

        // Przetwarzanie checkboxów jako tablic
        function processCheckboxes(formId, data) {
            document.querySelectorAll(`#${formId} input[type="checkbox"]`).forEach((checkbox) => {
                if (!data[checkbox.name]) {
                    data[checkbox.name] = [];
                } else if (!Array.isArray(data[checkbox.name])) {
                    data[checkbox.name] = [data[checkbox.name]];
                }
            });

            document.querySelectorAll(`#${formId} input[type="checkbox"]:checked`).forEach((checkbox) => {
                if (!data[checkbox.name].includes(checkbox.value)) {
                    data[checkbox.name].push(checkbox.value);
                }
            });
        }

        processCheckboxes('archForm', archData);
        processCheckboxes('infoForm', infoData);

        const combinedData = {
            sheetId,
            formType: "both",
            architectural: archData,
            informational: infoData
        };

        console.log("Zapisywanie do arkusza Google Sheets:", combinedData);

        try {
            const response = await fetch("http://localhost:3000/save-to-sheet", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(combinedData),
            });

            const result = await response.text();
            alert(result);
        } catch (error) {
            console.error("Błąd podczas zapisu do arkusza:", error);
            alert("Wystąpił błąd podczas zapisu do arkusza.");
        } finally {
            hideLoading(); // Ukryj spinner niezależnie od wyniku
        }
    });

    function showLoading() {
        document.getElementById("bothActionButtons").style.display = "none"; // Ukrywa przyciski
        document.getElementById("loadingSpinner").style.display = "flex"; // Pokazuje spinner
    }

    function hideLoading() {
        document.getElementById("loadingSpinner").style.display = "none"; // Ukrywa spinner
        document.getElementById("bothActionButtons").style.display = "flex"; // Pokazuje przyciski
    }


</script>

</html>